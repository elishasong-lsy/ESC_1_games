<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¶é—´æ”€ç™»è€… - ä¹±çŸ³é˜µæŒ‘æˆ˜ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            margin: 0;
            overflow: hidden;
            background-color: #0f172a;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(to bottom, #1e293b, #0f172a);
        }

        /* é»‘è‰²é™©å³»æ‚¬å´– */
        .cliff {
            position: absolute;
            right: 0;
            top: 0;
            width: 150px; /* ç¨å¾®çª„ä¸€ç‚¹ï¼Œè…¾å‡ºæ›´å¤šç©ºé—´ */
            height: 100%;
            background: #111;
            box-shadow: -10px 0 30px rgba(0,0,0,0.5);
            z-index: 2;
        }
        .cliff::after {
            content: '';
            position: absolute;
            left: -20px;
            top: 0;
            width: 40px;
            height: 100%;
            background: inherit;
            clip-path: polygon(100% 0, 100% 100%, 0 95%, 40% 85%, 0 75%, 50% 65%, 0 50%, 60% 35%, 0 20%, 50% 10%);
        }

        /* è§’è‰² - å˜å°å¹¶æŒªåˆ°æœ€å³ä¾§è¾¹ç¼˜ */
        #climber {
            position: absolute;
            right: 15px; /* ç´§è´´æ‚¬å´–å³ä¾§è¾¹ç¼˜ */
            bottom: 80px;
            font-size: 2.5rem; /* ç¼©å°å°ºå¯¸ï¼Œä¸å†ç¢äº‹ */
            z-index: 10;
            transition: bottom 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.5));
            user-select: none;
        }

        /* é™¨çŸ³æ ·å¼ */
        .rock {
            position: absolute;
            padding: 15px 25px;
            background: radial-gradient(circle at 30% 30%, #4b5563, #1f2937);
            color: white;
            border-radius: 50% 40% 60% 45%;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 6px 12px rgba(0,0,0,0.5);
            border: 2px solid #374151;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-width: 100px;
            font-size: 1.2rem;
            transition: transform 0.1s;
        }
        .rock:active { transform: scale(0.9); }

        /* å·¦ä¾§é¢æ¿ (HUD) */
        #side-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 280px;
            background: rgba(15, 23, 42, 0.85);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            color: white;
            z-index: 50;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* æµ·æ´‹ */
        .ocean {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 80px;
            background: #075985;
            z-index: 20;
        }
        .wave {
            position: absolute;
            top: -20px;
            width: 200%;
            height: 40px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23075985" d="M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,149.3C672,149,768,203,864,202.7C960,203,1056,149,1152,128C1248,107,1344,117,1392,122.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>');
            background-size: 50% 100%;
            animation: wave-move 10s linear infinite;
        }

        #overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
        }

        @keyframes wave-move { from { transform: translateX(0); } to { transform: translateX(-50%); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        .shake-ui { animation: shake 0.5s; }
    </style>
</head>
<body>

<div id="game-container">
    <!-- å·¦ä¾§ä»»åŠ¡é¢æ¿ -->
    <div id="side-panel">
        <div class="mb-4">
            <div class="text-xs uppercase tracking-widest text-gray-400 mb-1">æ”€çˆ¬è¿›åº¦</div>
            <div class="text-2xl font-bold text-yellow-400"><span id="height-val">0</span> / 200m</div>
            <div class="w-full h-2 bg-gray-700 rounded-full mt-2 overflow-hidden border border-gray-600">
                <div id="progress-bar" class="h-full bg-yellow-400 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>
        
        <div id="question-box" class="pt-4 border-t border-gray-700">
            <div class="text-xs uppercase tracking-widest text-gray-400 mb-1">å½“å‰ç›®æ ‡ä»»åŠ¡</div>
            <div id="q-text" class="text-xl font-bold text-white mb-1">åŠ è½½ä¸­...</div>
            <div id="q-pinyin" class="text-sm text-sky-300 italic"></div>
        </div>
    </div>

    <!-- åœºæ™¯ -->
    <div class="cliff"></div>
    <div id="climber">ğŸ§—</div>
    <div id="rock-container"></div>

    <!-- å¤§æµ· -->
    <div class="ocean">
        <div class="wave"></div>
    </div>
</div>

<div id="overlay">
    <h2 id="overlay-title" class="text-6xl font-bold mb-6"></h2>
    <p id="overlay-msg" class="text-2xl mb-10 whitespace-pre-line"></p>
    <button onclick="resetGame()" class="bg-yellow-500 hover:bg-yellow-600 text-black px-12 py-4 rounded-full text-2xl font-bold transform transition hover:scale-110 active:scale-95">
        é‡æ–°å¼€å§‹
    </button>
</div>

<script>
    const vocabPool = [
        { q: "o'clock", p: "diÇn", a: "ç‚¹" },
        { q: "minute", p: "fÄ“n", a: "åˆ†" },
        { q: "zero", p: "lÃ­ng", a: "é›¶" },
        { q: "quarter", p: "kÃ¨", a: "åˆ»" },
        { q: "half", p: "bÃ n", a: "åŠ" },
        { q: "two (measure words)", p: "liÇng", a: "ä¸¤" },
        { q: "Morning (Early)", p: "zÇo shang", a: "æ—©ä¸Š" },
        { q: "Morning (Late)", p: "shÃ ng wÇ”", a: "ä¸Šåˆ" },
        { q: "Noon", p: "zhÅng wÇ”", a: "ä¸­åˆ" },
        { q: "Afternoon", p: "xiÃ  wÇ”", a: "ä¸‹åˆ" },
        { q: "Evening/Night", p: "wÇn shang", a: "æ™šä¸Š" },
        { q: "Fall short of", p: "chÃ ", a: "å·®" },
        { q: "What time is it?", p: "XiÃ nzÃ i jÇ diÇn le?", a: "ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ" },
        { q: "It's 9:15", p: "XiÃ nzÃ i jiÇ” diÇn yÃ­ kÃ¨", a: "ç°åœ¨ä¹ç‚¹ä¸€åˆ»" },
        { q: "It's 11:30", p: "XiÃ nzÃ i shÃ­ yÄ« diÇn bÃ n", a: "ç°åœ¨åä¸€ç‚¹åŠ" },
        { q: "It's 8:05", p: "XiÃ nzÃ i bÄ diÇn lÃ­ng wÇ” fÄ“n", a: "ç°åœ¨å…«ç‚¹é›¶äº”åˆ†" },
        { q: "11:00 PM", p: "wÇnshang shÃ­yÄ« diÇn", a: "æ™šä¸Šåä¸€ç‚¹" },
        { q: "6:50 PM", p: "wÇnshang liÃ¹ diÇn wÇ” shÃ­ fÄ“n", a: "æ™šä¸Šå…­ç‚¹äº”ååˆ†" },
        { q: "7:50 AM", p: "zÇoshang chÃ  shÃ­ fÄ“n bÄ diÇn", a: "æ—©ä¸Šå·®ååˆ†å…«ç‚¹" }
    ];

    let height = 0;
    const WIN_HEIGHT = 200;
    const STEP = 25;
    const FALL_STEP = 35;
    let gameActive = true;
    let activeRocks = [];
    let currentCorrectAnswer = "";

    const climber = document.getElementById('climber');
    const heightVal = document.getElementById('height-val');
    const progressBar = document.getElementById('progress-bar');
    const qText = document.getElementById('q-text');
    const qPinyin = document.getElementById('q-pinyin');
    const rockContainer = document.getElementById('rock-container');
    const overlay = document.getElementById('overlay');
    const sidePanel = document.getElementById('side-panel');

    function initGame() {
        height = 0;
        updateUI();
        gameActive = true;
        nextQuestion();
    }

    function updateUI() {
        heightVal.innerText = height;
        const progress = (height / WIN_HEIGHT) * 100;
        progressBar.style.width = `${progress}%`;
        
        const minY = 80;
        const maxY = window.innerHeight - 150;
        const currentY = minY + ( (height / WIN_HEIGHT) * (maxY - minY) );
        climber.style.bottom = `${currentY}px`;
    }

    function nextQuestion() {
        if (!gameActive) return;
        
        activeRocks.forEach(r => r.remove());
        activeRocks = [];

        const question = vocabPool[Math.floor(Math.random() * vocabPool.length)];
        qText.innerText = question.q;
        qPinyin.innerText = question.p;
        currentCorrectAnswer = question.a;

        // ç”Ÿæˆ 6 ä¸ªé€‰é¡¹
        let options = [question.a];
        while(options.length < 6) {
            let randA = vocabPool[Math.floor(Math.random() * vocabPool.length)].a;
            if(!options.includes(randA)) options.push(randA);
        }
        options = options.sort(() => Math.random() - 0.5);

        options.forEach((opt, index) => {
            setTimeout(() => {
                if(!gameActive) return;
                createRock(opt, opt === currentCorrectAnswer);
            }, index * 1200); 
        });
    }

    function createRock(text, isCorrect) {
        const rock = document.createElement('div');
        rock.className = 'rock';
        rock.innerText = text;
        
        // èŒƒå›´ï¼šé¿å¼€å·¦ä¾§é¢æ¿ï¼Œä¸”ç»™å³ä¾§æ‚¬å´–ç•™å‡ºç©ºé—´
        const startX = Math.random() * (window.innerWidth - 500) + 320;
        rock.style.left = `${startX}px`;
        rock.style.top = `-100px`;
        
        rockContainer.appendChild(rock);
        activeRocks.push(rock);

        let posY = -100;
        const speed = 1.2 + (height / 250); 
        
        const fallInterval = setInterval(() => {
            if (!gameActive) {
                clearInterval(fallInterval);
                return;
            }

            posY += speed;
            rock.style.top = `${posY}px`;

            if (posY > window.innerHeight - 80) {
                clearInterval(fallInterval);
                rock.remove();
                activeRocks = activeRocks.filter(r => r !== rock);
                if (isCorrect) handleResult(false, true);
            }
        }, 16);

        rock.onclick = (e) => {
            e.stopPropagation();
            clearInterval(fallInterval);
            rock.remove();
            activeRocks = activeRocks.filter(r => r !== rock);
            handleResult(isCorrect, false);
        };
    }

    function handleResult(isCorrect, isMissed) {
        if (isCorrect) {
            height += STEP;
            climber.innerText = "ğŸ§—â€â™‚ï¸";
            if (height >= WIN_HEIGHT) {
                height = WIN_HEIGHT;
                updateUI();
                setTimeout(() => endGame(true), 500);
            } else {
                updateUI();
                nextQuestion();
            }
        } else {
            height -= FALL_STEP;
            if (height < 0) height = 0;
            updateUI();
            
            climber.innerText = isMissed ? "ğŸ˜®" : "ğŸ˜«";
            sidePanel.classList.add('shake-ui');
            
            setTimeout(() => {
                sidePanel.classList.remove('shake-ui');
                climber.innerText = "ğŸ§—";
                nextQuestion();
            }, 600);
        }
    }

    function endGame(isWin) {
        gameActive = false;
        overlay.style.display = 'flex';
        const title = document.getElementById('overlay-title');
        const msg = document.getElementById('overlay-msg');
        
        if (isWin) {
            title.innerText = "ğŸš© ç™»é¡¶æˆåŠŸï¼";
            msg.innerText = "ä½ æ˜¯æœ€æ£’çš„æ”€çˆ¬è€…ï¼\næ—¶é—´è¯æ±‡å·²ç»éš¾ä¸å€’ä½ äº†ã€‚";
            climber.innerText = "ğŸ†";
        } else {
            title.innerText = "ğŸŒŠ å å…¥æ·±æµ·";
            msg.innerText = "åˆ«ç°å¿ƒï¼ä¹±çŸ³é˜µç¡®å®æœ‰æŒ‘æˆ˜ã€‚\nå†è¯•ä¸€æ¬¡ï¼Œæ³¨æ„å·¦ä¸Šè§’çš„ä»»åŠ¡ï¼";
            climber.innerText = "ğŸŠ";
        }
    }

    function resetGame() {
        overlay.style.display = 'none';
        rockContainer.innerHTML = '';
        height = 0;
        climber.innerText = "ğŸ§—";
        updateUI();
        gameActive = true;
        nextQuestion();
    }

    window.onload = initGame;
</script>

</body>
</html>
