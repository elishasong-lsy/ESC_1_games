<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ESC-1-4 Part 2ï½œæ‚¬å´–æ”€ç™» Cliff Climbï¼ˆè¯/å­—/å¥å­ï¼‰v1.3</title>

  <style>
    :root{
      --bg1:#041021;
      --bg2:#00030a;
      --panel: rgba(255,255,255,.10);
      --border: rgba(255,255,255,.18);
      --text:#f4f7ff;
      --muted:#c3cffc;
      --accent:#ffd54a;
      --good:#63ffb0;
      --bad:#ff5f86;
      --shadow: 0 22px 70px rgba(0,0,0,.70);
      --radius: 18px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans",sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 18% 10%, rgba(120,110,255,.25), transparent 55%),
        radial-gradient(1200px 800px at 90% 35%, rgba(255,213,74,.18), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
      user-select:none;
      -webkit-user-select:none;
    }

    /* HUD */
    .hud{
      position:fixed;
      top:14px; left:14px; right:14px;
      display:flex; gap:12px;
      z-index:50;
      pointer-events:none;
    }
    .card{
      pointer-events:auto;
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:12px 14px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .left{ flex:1 1 auto; }
    .right{ flex:0 0 auto; min-width: 290px; }

    .title{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      flex-wrap:wrap;
    }
    .title h1{
      margin:0;
      font-size:16px;
      color:var(--muted);
      font-weight:900;
      letter-spacing:.2px;
    }

    .modebar{
      margin-top:10px;
      display:flex; gap:8px; align-items:center; flex-wrap:wrap;
    }
    .btn{
      cursor:pointer;
      border:none;
      border-radius:12px;
      padding:10px 12px;
      background:rgba(255,255,255,.12);
      color:var(--text);
      border:1px solid rgba(255,255,255,.18);
      font-weight:900;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .btn:hover{ background:rgba(255,255,255,.16); }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn.on{
      border-color: rgba(255,213,74,.70);
      box-shadow: 0 0 0 5px rgba(255,213,74,.12);
    }

    .prompt{
      margin-top:10px;
      display:grid;
      gap:8px;
    }
    .promptBig{
      font-size:30px;
      font-weight:1000;
      color:var(--accent);
      text-shadow: 0 10px 26px rgba(255,213,74,.28);
      line-height:1.05;
    }
    .hint{
      font-size:14px;
      color:var(--muted);
      line-height:1.3;
    }

    /* å¥å­è¿›åº¦æ¡ */
    .progress{
      margin-top:6px;
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
      font-size:18px;
    }
    .tok{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.24);
      color: rgba(255,255,255,.96);
      font-weight:1000;
    }
    .tok.done{
      border-color: rgba(99,255,176,.55);
      background: rgba(99,255,176,.14);
      color: rgba(99,255,176,.98);
    }
    .tok.now{
      border-color: rgba(255,213,74,.80);
      background: rgba(255,213,74,.18);
      color: rgba(255,213,74,.98);
      box-shadow: 0 0 0 5px rgba(255,213,74,.10);
    }

    /* âœ… æ°¸è¿œå¯è§çš„â€œé€‰é¡¹æ¡â€ï¼ˆå…³é”®ä¿®å¤ï¼‰ */
    #choiceBar{
      margin-top:8px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .choice{
      cursor:pointer;
      border-radius:16px;
      padding:12px 16px;
      background:rgba(0,0,0,.30);
      border:1px solid rgba(255,255,255,.18);
      color:#fff;
      font-weight:1000;
      font-size:20px;
      min-width:64px;
      text-align:center;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .choice:hover{ border-color: rgba(255,213,74,.80); background:rgba(0,0,0,.36); }
    .choice:active{ transform: translateY(1px) scale(.99); }
    .choice.good{
      border-color: rgba(99,255,176,.75);
      box-shadow: 0 0 0 6px rgba(99,255,176,.12);
    }
    .choice.bad{
      border-color: rgba(255,95,134,.85);
      box-shadow: 0 0 0 6px rgba(255,95,134,.14);
    }

    .stats{
      display:flex; flex-wrap:wrap; gap:10px; align-items:center;
      color:var(--muted);
      font-size:14px;
      justify-content:flex-end;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background:rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
    }
    .pill b{ color:var(--text); font-weight:1000; }

    /* Scene */
    #scene{
      position:fixed;
      inset:0;
      z-index:1;
      overflow:hidden;
    }
    .ocean{
      position:absolute; left:0; right:0; bottom:0;
      height:38vh;
      background:
        radial-gradient(900px 260px at 30% 20%, rgba(120,210,255,.30), transparent 60%),
        radial-gradient(900px 260px at 70% 40%, rgba(0,120,255,.22), transparent 60%),
        linear-gradient(180deg, rgba(0,30,70,.40), rgba(0,10,20,.96));
    }
    .ocean:before{
      content:"";
      position:absolute; inset:-40px 0 0 0;
      background: repeating-linear-gradient(90deg, rgba(255,255,255,.05) 0px, rgba(255,255,255,.05) 14px, rgba(0,0,0,0) 14px, rgba(0,0,0,0) 34px);
      opacity:.40;
      animation: waves 10s linear infinite;
    }
    @keyframes waves{ 0%{transform:translateX(0)} 100%{transform:translateX(-220px)} }

    .cliff{
      position:absolute;
      left:-6vw; top:0;
      width:58vw; height:100vh;
      background:
        radial-gradient(900px 800px at 40% 20%, rgba(255,255,255,.12), transparent 60%),
        linear-gradient(120deg, rgba(40,45,70,.95), rgba(12,14,22,.98));
      clip-path: polygon(0 0, 86% 0, 72% 32%, 90% 60%, 72% 100%, 0 100%);
      border-right: 1px solid rgba(255,255,255,.12);
      box-shadow: 20px 0 60px rgba(0,0,0,.55);
    }
    .sky{
      position:absolute; inset:0;
      background:
        radial-gradient(900px 600px at 70% 10%, rgba(255,213,74,.12), transparent 55%),
        radial-gradient(900px 600px at 90% 30%, rgba(130,110,255,.14), transparent 60%);
      pointer-events:none;
    }

    /* Climber */
    .climber{
      position:fixed;
      left: 44vw;
      top: 68vh;
      width:62px; height:62px;
      border-radius: 18px;
      display:flex; align-items:center; justify-content:center;
      font-size:34px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 22px 55px rgba(0,0,0,.55);
      z-index:45;
      transition: top .35s ease, left .35s ease;
      pointer-events:none;
    }
    .climber.fall{ animation: drop .42s ease-in; }
    @keyframes drop{
      0%{ transform: translateY(0) rotate(0deg); }
      100%{ transform: translateY(22px) rotate(8deg); }
    }

    /* Overlay */
    .overlay{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      z-index:80;
      background: rgba(0,0,0,.40);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .modal{
      width:min(900px, 92vw);
      padding:18px 18px 16px;
      border-radius:22px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
    }
    .modal h2{ margin:0 0 8px; font-size:20px; }
    .modal p{ margin:8px 0; color:var(--muted); line-height:1.45; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px;
      padding:4px 8px;
      border-radius:10px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.14);
      color:var(--text);
    }

    @media (max-width: 780px){
      .promptBig{ font-size:26px; }
      .right{ min-width: 250px; }
      .climber{ left: 56vw; }
      .choice{ font-size:18px; padding:10px 14px; }
    }
  </style>
</head>

<body>
  <div class="hud">
    <div class="card left">
      <div class="title">
        <h1>ESC-1-4 Part 2ï½œæ‚¬å´–æ”€ç™» Cliff Climbï¼ˆè¯ / å­— / å¥å­ï¼‰v1.3</h1>
      </div>

      <div class="modebar">
        <button class="btn on" id="btnModeWord">è¯è¯­</button>
        <button class="btn" id="btnModeChar">å•å­—</button>
        <button class="btn" id="btnModeSentence">å¥å­é¡ºåº</button>
        <span style="color:var(--muted);font-size:13px;">ç­”å¯¹ä¸Šå‡ï¼›ç­”é”™ä¸‹æ»‘ï¼›ä¸è®¡æ—¶</span>
      </div>

      <div class="prompt">
        <div class="promptBig" id="promptBig">zÇoshang</div>
        <div class="hint" id="hint">ç‚¹å‡»æ­£ç¡®çš„è¯è¯­ã€‚</div>

        <div class="progress" id="progress" style="display:none;"></div>

        <!-- âœ… æ°¸è¿œå¯è§çš„é€‰é¡¹æ¡ -->
        <div id="choiceBar"></div>
      </div>
    </div>

    <div class="card right">
      <div class="stats">
        <div class="pill">âœ… åˆ†æ•° <b id="score">0</b></div>
        <div class="pill">â¤ï¸ ç”Ÿå‘½ <b id="lives">3</b></div>
        <button class="btn" id="btnPause">æš‚åœ</button>
        <button class="btn" id="btnReset">é‡æ¥</button>
      </div>
    </div>
  </div>

  <div id="scene">
    <div class="sky"></div>
    <div class="cliff"></div>
    <div class="ocean"></div>
  </div>

  <div class="climber" id="climber">ğŸ§—</div>

  <div class="overlay" id="overlay">
    <div class="modal">
      <h2 id="ovTitle">å·²æš‚åœ</h2>
      <p id="ovMsg">ç‚¹â€œç»§ç»­â€å›åˆ°æ¸¸æˆã€‚</p>
      <div class="row">
        <span class="kbd">ç©ºæ ¼ = æš‚åœ/ç»§ç»­</span>
        <span class="kbd">R = é‡æ¥</span>
        <span class="kbd">1/2/3 = åˆ‡æ¢æ¨¡å¼</span>
      </div>
      <div class="row">
        <button class="btn" id="btnGo">ç»§ç»­</button>
      </div>
    </div>
  </div>

<script>
/* =========================
   DATA (ESC-1-4 Part 2)
   ========================= */
const WORDS = [
  {p:"zÇo", zh:"æ—©"},
  {p:"shÃ ng", zh:"ä¸Š"},
  {p:"zÇoshang", zh:"æ—©ä¸Š"},
  {p:"wÇ”", zh:"åˆ"},
  {p:"shÃ ngwÇ”", zh:"ä¸Šåˆ"},
  {p:"zhÅng", zh:"ä¸­"},
  {p:"zhÅngwÇ”", zh:"ä¸­åˆ"},
  {p:"xiÃ ", zh:"ä¸‹"},
  {p:"xiÃ wÇ”", zh:"ä¸‹åˆ"},
  {p:"wÇn", zh:"æ™š"},
  {p:"wÇnshang", zh:"æ™šä¸Š"},
  {p:"chÃ ", zh:"å·®"},
];

const CHAR_ONLY = [
  {p:"zÇo", zh:"æ—©"},
  {p:"shÃ ng", zh:"ä¸Š"},
  {p:"wÇ”", zh:"åˆ"},
  {p:"zhÅng", zh:"ä¸­"},
  {p:"xiÃ ", zh:"ä¸‹"},
  {p:"wÇn", zh:"æ™š"},
  {p:"chÃ ", zh:"å·®"},
];

const SENTENCES = [
  { p:"xiÃ n zÃ i zÇoshang wÇ” diÇn wÇ” shÃ­ fÄ“n", zh:"ç°åœ¨æ—©ä¸Šäº”ç‚¹äº”ååˆ†ã€‚", tokens:["ç°","åœ¨","æ—©","ä¸Š","äº”","ç‚¹","äº”","å","åˆ†"] },
  { p:"xiÃ n zÃ i shÃ ngwÇ” shÃ­ diÇn wÇ” shÃ­ fÄ“n", zh:"ç°åœ¨ä¸Šåˆåç‚¹äº”ååˆ†ã€‚", tokens:["ç°","åœ¨","ä¸Š","åˆ","å","ç‚¹","äº”","å","åˆ†"] },
  { p:"xiÃ n zÃ i zhÅngwÇ” shÃ­ Ã¨r diÇn wÇ” shÃ­ fÄ“n", zh:"ç°åœ¨ä¸­åˆåäºŒç‚¹äº”ååˆ†ã€‚", tokens:["ç°","åœ¨","ä¸­","åˆ","å","äºŒ","ç‚¹","äº”","å","åˆ†"] },
  { p:"xiÃ n zÃ i xiÃ wÇ” wÇ” diÇn wÇ” shÃ­ fÄ“n", zh:"ç°åœ¨ä¸‹åˆäº”ç‚¹äº”ååˆ†ã€‚", tokens:["ç°","åœ¨","ä¸‹","åˆ","äº”","ç‚¹","äº”","å","åˆ†"] },
  { p:"xiÃ n zÃ i wÇnshang liÃ¹ diÇn wÇ” shÃ­ fÄ“n", zh:"ç°åœ¨æ™šä¸Šå…­ç‚¹äº”ååˆ†ã€‚", tokens:["ç°","åœ¨","æ™š","ä¸Š","å…­","ç‚¹","äº”","å","åˆ†"] },
  { p:"xiÃ n zÃ i chÃ  shÃ­ fÄ“n bÄ diÇn", zh:"ç°åœ¨å·®ååˆ†å…«ç‚¹ã€‚", tokens:["ç°","åœ¨","å·®","å","åˆ†","å…«","ç‚¹"] },
];

const CHAR_POOL = ["ç°","åœ¨","æ—©","ä¸Š","åˆ","ä¸­","ä¸‹","æ™š","å·®","ç‚¹","åˆ†","å","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","ä¸ƒ","å…«","ä¹","é›¶"];

/* =========================
   STATE
   ========================= */
const climber = document.getElementById("climber");
const promptBig = document.getElementById("promptBig");
const hint = document.getElementById("hint");
const progress = document.getElementById("progress");
const choiceBar = document.getElementById("choiceBar");

const scoreEl = document.getElementById("score");
const livesEl = document.getElementById("lives");

const overlay = document.getElementById("overlay");
const ovTitle = document.getElementById("ovTitle");
const ovMsg = document.getElementById("ovMsg");
const btnGo = document.getElementById("btnGo");

const btnPause = document.getElementById("btnPause");
const btnReset = document.getElementById("btnReset");

const btnModeWord = document.getElementById("btnModeWord");
const btnModeChar = document.getElementById("btnModeChar");
const btnModeSentence = document.getElementById("btnModeSentence");

let running=false;
let paused=false;

let mode="word"; // word | char | sentence
let score=0;
let lives=3;

let target=null;
let sentence=null;
let sIndex=0;

let stage=0;
const STAGES=10;

/* =========================
   HELPERS
   ========================= */
function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function shuffle(a){
  const b=[...a];
  for(let i=b.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [b[i],b[j]]=[b[j],b[i]];
  }
  return b;
}
function updateHUD(){ scoreEl.textContent=String(score); livesEl.textContent=String(lives); }
function showOverlay(title, message){
  ovTitle.textContent = title;
  ovMsg.textContent = message;
  overlay.style.display="flex";
}
function hideOverlay(){ overlay.style.display="none"; }

/* =========================
   CLIMBER
   ========================= */
function placeClimber(){
  const t = stage / STAGES;
  const topY = 18, bottomY = 76;
  const y = bottomY - (bottomY-topY)*t;
  const x = 44 - 8*Math.sin(t*Math.PI);
  climber.style.top = y + "vh";
  climber.style.left = x + "vw";
}
function climbUp(){
  stage = Math.min(STAGES, stage+1);
  placeClimber();
  if(stage >= STAGES){
    running=false;
    showOverlay("é€šå…³ï¼", "ä½ çˆ¬åˆ°é¡¶äº†ï¼ç‚¹â€œç»§ç»­â€é‡å¼€ã€‚");
  }
}
function slipDown(){
  stage = Math.max(0, stage-1);
  climber.classList.add("fall");
  setTimeout(()=>climber.classList.remove("fall"), 450);
  placeClimber();

  if(stage===0){
    lives -= 1;
    updateHUD();
    if(lives<=0){
      running=false;
      showOverlay("æ‰è¿›æµ·é‡Œäº†â€¦", "æ¸¸æˆç»“æŸã€‚ç‚¹â€œç»§ç»­â€é‡å¼€ã€‚");
    }
  }
}

/* =========================
   UI BUILDERS
   ========================= */
function renderSentenceProgress(){
  progress.innerHTML="";
  sentence.tokens.forEach((t,i)=>{
    const s=document.createElement("span");
    s.className="tok";
    s.textContent=t;
    if(i<sIndex) s.classList.add("done");
    if(i===sIndex) s.classList.add("now");
    progress.appendChild(s);
  });
}

function renderChoices(choices, correctText){
  choiceBar.innerHTML="";
  choices.forEach(t=>{
    const b=document.createElement("button");
    b.className="choice";
    b.textContent=t;
    b.onclick=()=> {
      if(!running || paused) return;
      const ok = (t===correctText);
      if(ok){ b.classList.add("good"); setTimeout(()=>b.classList.remove("good"), 350); }
      else{ b.classList.add("bad"); setTimeout(()=>b.classList.remove("bad"), 350); }
      onChoose(ok);
    };
    choiceBar.appendChild(b);
  });
}

/* =========================
   GAME LOGIC
   ========================= */
function nextWordTarget(){
  target = pick(WORDS);
  promptBig.textContent = target.p;
  hint.textContent = "ç‚¹å‡»æ­£ç¡®çš„è¯è¯­ã€‚";
  progress.style.display="none";

  const pool = WORDS.map(x=>x.zh);
  const distract = shuffle(pool.filter(z=>z!==target.zh)).slice(0,3);
  const choices = shuffle([target.zh, ...distr]);
  renderChoices(choices, target.zh);
}

function nextCharTarget(){
  target = pick(CHAR_ONLY);
  promptBig.textContent = target.p;
  hint.textContent = "ç‚¹å‡»æ­£ç¡®çš„å•å­—ã€‚";
  progress.style.display="none";

  const pool = CHAR_ONLY.map(x=>x.zh);
  const distract = shuffle(pool.filter(z=>z!==target.zh)).slice(0,3);
  const choices = shuffle([target.zh, ...distr]);
  renderChoices(choices, target.zh);
}

function nextSentence(){
  sentence = pick(SENTENCES);
  sIndex = 0;
  promptBig.textContent = sentence.p;
  hint.textContent = "æŒ‰é¡ºåºç‚¹å‡»å¥å­é‡Œçš„ä¸‹ä¸€ä¸ªå­—ã€‚";
  progress.style.display="flex";
  renderSentenceProgress();

  const need = sentence.tokens[sIndex];
  const distract = shuffle(CHAR_POOL.filter(c=>c!==need)).slice(0,4);
  const choices = shuffle([need, ...distr]);
  renderChoices(choices, need);
}

function newRound(){
  if(mode==="word") nextWordTarget();
  else if(mode==="char") nextCharTarget();
  else nextSentence();
}

function onChoose(isCorrect){
  if(isCorrect){
    score += 1; updateHUD();
    climbUp();

    if(mode==="sentence"){
      sIndex += 1;
      if(sIndex >= sentence.tokens.length){
        score += 2; updateHUD();
        nextSentence();
      }else{
        renderSentenceProgress();
        const need = sentence.tokens[sIndex];
        const distract = shuffle(CHAR_POOL.filter(c=>c!==need)).slice(0,4);
        const choices = shuffle([need, ...distr]);
        renderChoices(choices, need);
      }
    }else{
      newRound();
    }
  }else{
    slipDown();
  }
}

/* =========================
   CONTROLS
   ========================= */
function setMode(m){
  mode=m;
  btnModeWord.classList.toggle("on", mode==="word");
  btnModeChar.classList.toggle("on", mode==="char");
  btnModeSentence.classList.toggle("on", mode==="sentence");
  newRound();
}

function resetGame(){
  running=true; paused=false;
  score=0; lives=3; stage=0; sIndex=0;
  updateHUD();
  placeClimber();
  hideOverlay();
  newRound();
}

function togglePause(){
  if(!running) return;
  paused = !paused;
  btnPause.textContent = paused ? "ç»§ç»­" : "æš‚åœ";
  if(paused) showOverlay("å·²æš‚åœ", "ç‚¹â€œç»§ç»­â€å›åˆ°æ¸¸æˆã€‚");
  else hideOverlay();
}

btnGo.addEventListener("click",()=>{
  if(!running || lives<=0 || stage>=STAGES){ resetGame(); return; }
  paused=false; hideOverlay(); btnPause.textContent="æš‚åœ";
});
btnPause.addEventListener("click",()=> togglePause());
btnReset.addEventListener("click",()=> resetGame());

btnModeWord.addEventListener("click",()=> setMode("word"));
btnModeChar.addEventListener("click",()=> setMode("char"));
btnModeSentence.addEventListener("click",()=> setMode("sentence"));

window.addEventListener("keydown",(e)=>{
  if(e.code==="Space"){ e.preventDefault(); togglePause(); }
  if(e.key.toLowerCase()==="r"){ e.preventDefault(); resetGame(); }
  if(e.key==="1"){ setMode("word"); }
  if(e.key==="2"){ setMode("char"); }
  if(e.key==="3"){ setMode("sentence"); }
});

/* =========================
   INIT
   ========================= */
placeClimber();
updateHUD();
running = true;
paused = false;

// é»˜è®¤æ¨¡å¼ï¼šä½ æƒ³é»˜è®¤è¯è¯­å°±æ”¹æˆ "word"
setMode("sentence");
</script>
</body>
</html>
