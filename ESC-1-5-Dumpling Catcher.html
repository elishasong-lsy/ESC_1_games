<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ESC-1-5 ü•ü Â§©‰∏äÊéâÈ•∫Â≠ê Dumpling Catcher</title>
  <style>
    :root{
      --ink:#f8fafc;
      --muted:#cbd5e1;
      --panel:rgba(15,23,42,.72);
      --line:rgba(148,163,184,.25);
      --accent:#a78bfa;
      --good:#22c55e;
      --bad:#f87171;
      --bg1:#030712;   /* near black */
      --bg2:#111827;   /* slate */
    }
    html,body{height:100%; margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans,Helvetica,Arial;}
    body{
      background:radial-gradient(1200px 600px at 20% 10%, #0b1224 0%, var(--bg1) 45%, var(--bg2) 100%);
      color:var(--ink);
      display:flex; align-items:center; justify-content:center;
      padding:12px;
    }
    .wrap{
      width:min(1250px,100%);
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:14px;
    }
    .card{
      border:1px solid var(--line);
      border-radius:18px;
      background:rgba(2,6,23,.35);
      box-shadow:0 18px 55px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .stage{position:relative;}
    canvas{display:block; width:100%; height:auto;}
    /* top HUD */
    .hud{
      position:absolute; left:14px; top:14px;
      display:flex; gap:12px; flex-wrap:wrap;
      background:rgba(2,6,23,.55);
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px 12px;
      backdrop-filter: blur(8px);
      align-items:center;
    }
    .pill{display:flex; gap:10px; align-items:baseline;}
    .pill b{font-size:15px; letter-spacing:.02em;}
    .pill span{font-size:15px; color:var(--muted); font-weight:700;}
    /* buttons */
    .controls{
      position:absolute; right:14px; top:14px;
      display:flex; gap:10px;
      background:rgba(2,6,23,.55);
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px 12px;
      backdrop-filter: blur(8px);
    }
    button{
      border:1px solid rgba(148,163,184,.35);
      background:rgba(255,255,255,.06);
      color:var(--ink);
      border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:800;
      font-size:14px;
    }
    button:hover{border-color:rgba(255,255,255,.35)}
    button.primary{
      background:linear-gradient(90deg, rgba(167,139,250,.85), rgba(56,189,248,.75));
      border-color:transparent;
      color:#0b1224;
    }
    button.primary:hover{filter:brightness(1.05)}
    button:disabled{opacity:.55; cursor:not-allowed}

    /* right panel */
    .side{padding:16px; display:flex; flex-direction:column; gap:12px;}
    .title{
      padding:14px 14px 0 14px;
    }
    .title h1{
      margin:0;
      font-size:18px;
      line-height:1.25;
      white-space:normal; /* allow wrap */
      word-break:break-word;
    }
    .title p{
      margin:8px 0 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
    }
    .prompt{
      padding:14px;
      border:1px solid rgba(167,139,250,.35);
      background:rgba(167,139,250,.10);
      border-radius:16px;
      display:flex; flex-direction:column; gap:10px;
    }
    .prompt .label{
      font-size:12px; color:var(--muted);
      text-transform:uppercase; letter-spacing:.1em;
    }
    .prompt .big{font-size:30px; font-weight:900; letter-spacing:.01em;}
    .prompt .small{font-size:14px; color:var(--muted);}
    .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .toggle{display:flex; gap:8px; align-items:center; font-size:13px; color:var(--muted); font-weight:700}
    .toggle input{transform:scale(1.15)}
    .help{
      padding:14px;
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(2,6,23,.35);
      color:var(--muted);
      font-size:13px;
      line-height:1.5;
    }
    .help b{color:var(--ink)}
    .list{
      padding:14px;
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(2,6,23,.35);
    }
    .list h3{margin:0 0 10px 0; font-size:14px; color:var(--ink);}
    .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip{
      border:1px solid rgba(148,163,184,.28);
      border-radius:999px;
      padding:8px 10px;
      font-size:12px;
      color:var(--muted);
      background:rgba(255,255,255,.04);
      font-weight:800;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- LEFT: GAME -->
    <div class="card stage">
      <canvas id="game" width="980" height="600"></canvas>

      <div class="hud">
        <div class="pill"><b>Score</b> <span id="score">$0</span></div>
        <div class="pill"><b>Round</b> <span id="round">1</span></div>
        <div class="pill"><b>Streak</b> <span id="streak">0</span></div>
      </div>

      <div class="controls">
        <button id="startBtn" class="primary">Start</button>
        <button id="pauseBtn" disabled>Pause</button>
        <button id="repeatBtn" disabled>üîä Repeat</button>
      </div>
    </div>

    <!-- RIGHT: INFO -->
    <div class="card">
      <div class="title">
        <h1>ESC-1-5 ü•ü Â§©‰∏äÊéâÈ•∫Â≠ê Dumpling Catcher</h1>
        <p>ÊåâÂè≥‰æßÊèêÁ§∫Êé•Ê≠£Á°ÆÈ•∫Â≠ê„ÄÇÊé•ÂØπ +$100ÔºàË∂ÖÂ§ßÁæéÈáëÔºâÔºåÊé•Èîô üåøÔºàË∂ÖÂ§ßËçâÔºâ„ÄÇ</p>
      </div>

      <div class="side">
        <div class="prompt">
          <div class="label">Catch This</div>
          <div class="big" id="promptMain">‚Äî</div>
          <div class="small" id="promptSub">Press Start</div>
          <div class="row">
            <div class="toggle"><input id="audioToggle" type="checkbox" checked /> <label for="audioToggle">Auto audio</label></div>
            <div class="toggle"><input id="pinyinOnly" type="checkbox" /> <label for="pinyinOnly">Pinyin only</label></div>
            <div class="toggle"><input id="englishOnly" type="checkbox" /> <label for="englishOnly">English only</label></div>
          </div>
        </div>

        <div class="help">
          <b>Controls:</b> ‚Üê ‚Üí Êàñ A / D ÁßªÂä®ÔºõSpace ÊöÇÂÅú/ÁªßÁª≠„ÄÇ
        </div>

        <div class="list">
          <h3>Word List (WL1)</h3>
          <div class="chips" id="chips"></div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  // =========================
  // Vocabulary
  // =========================
  const VOCAB = [
    { hanzi:"Â•Ω",   pinyin:"h«éo",       en:"good / hi (polite)", speak:"Â•Ω" },
    { hanzi:"‰Ω†Â•Ω", pinyin:"n«ê h«éo",    en:"hello",             speak:"‰Ω†Â•Ω" },
    { hanzi:"Âßì",   pinyin:"x√¨ng",      en:"last name",         speak:"Âßì" },
    { hanzi:"È©¨",   pinyin:"m«é",        en:"Ma (surname)",      speak:"È©¨" },
    { hanzi:"Âè´",   pinyin:"ji√†o",      en:"to be called",      speak:"Âè´" },
    { hanzi:"‰ªÄ‰πà", pinyin:"sh√©nme",    en:"what",              speak:"‰ªÄ‰πà" },
    { hanzi:"Âêç",   pinyin:"m√≠ng",      en:"given name",        speak:"Âêç" },
    { hanzi:"Â≠ó",   pinyin:"z√¨",        en:"character / name",  speak:"Â≠ó" },
    { hanzi:"Áéã",   pinyin:"w√°ng",      en:"Wang (surname)",    speak:"Áéã" },
    { hanzi:"ÂÜç",   pinyin:"z√†i",       en:"again",             speak:"ÂÜç" },
    { hanzi:"ËßÅ",   pinyin:"ji√†n",      en:"see / meet",        speak:"ËßÅ" },
    { hanzi:"ÂÜçËßÅ", pinyin:"z√†iji√†n",   en:"goodbye",           speak:"ÂÜçËßÅ" },
  ];

  // UI chips
  const chips = document.getElementById("chips");
  VOCAB.forEach(v => {
    const s = document.createElement("span");
    s.className = "chip";
    s.textContent = `${v.hanzi} (${v.pinyin})`;
    chips.appendChild(s);
  });

  // Canvas
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");
  const W = canvas.width, H = canvas.height;

  // UI
  const scoreEl = document.getElementById("score");
  const roundEl = document.getElementById("round");
  const streakEl = document.getElementById("streak");
  const promptMainEl = document.getElementById("promptMain");
  const promptSubEl = document.getElementById("promptSub");
  const startBtn = document.getElementById("startBtn");
  const pauseBtn = document.getElementById("pauseBtn");
  const repeatBtn = document.getElementById("repeatBtn");
  const audioToggle = document.getElementById("audioToggle");
  const pinyinOnly = document.getElementById("pinyinOnly");
  const englishOnly = document.getElementById("englishOnly");

  // Game state
  const groundY = H - 96;

  const player = {
    x: W/2, y: groundY,
    speed: 520,
  };

  // BIGGER plate & hitbox
  function plateRect(){
    return { x: player.x - 86, y: player.y - 86, w: 172, h: 30 };
  }

  let dumplings = [];
  let floaters = [];

  let score = 0;
  let round = 1;
  let streak = 0;
  let running = false;
  let paused = false;

  // Slower spawn & fall (kids-friendly)
  let spawnTimer = 0;
  let spawnEvery = 1.35;     // slower spawn
  let fallBase = 75;         // MUCH slower fall
  let fallJitter = 45;

  // Target
  let target = null;

  // Keyboard
  const keys = new Set();
  window.addEventListener("keydown", (e) => {
    if(["ArrowLeft","ArrowRight","a","d","A","D"," "].includes(e.key)) e.preventDefault();
    if(e.key === " ") togglePause();
    keys.add(e.key);
  });
  window.addEventListener("keyup", (e) => keys.delete(e.key));

  // Speech
  function speakChinese(text){
    try{
      if(!("speechSynthesis" in window)) return;
      const u = new SpeechSynthesisUtterance(text);
      u.lang = "zh-CN";
      u.rate = 0.9;
      const voices = speechSynthesis.getVoices?.() || [];
      const zh = voices.find(v => (v.lang||"").toLowerCase().includes("zh")) || null;
      if(zh) u.voice = zh;
      speechSynthesis.cancel();
      speechSynthesis.speak(u);
    }catch(_){}
  }

  // Simple beep/buzz
  let audioCtx = null;
  function beep(type="good"){
    try{
      audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.connect(g); g.connect(audioCtx.destination);
      const now = audioCtx.currentTime;
      if(type === "good"){
        o.type="sine"; o.frequency.setValueAtTime(740, now);
        g.gain.setValueAtTime(0.0001, now);
        g.gain.exponentialRampToValueAtTime(0.22, now+0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, now+0.18);
        o.start(now); o.stop(now+0.2);
      }else{
        o.type="square"; o.frequency.setValueAtTime(160, now);
        g.gain.setValueAtTime(0.0001, now);
        g.gain.exponentialRampToValueAtTime(0.18, now+0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, now+0.28);
        o.start(now); o.stop(now+0.3);
      }
    }catch(_){}
  }

  // Prompt
  function pickTarget(){
    target = VOCAB[(round-1) % VOCAB.length];
    roundEl.textContent = String(round);

    let main = "";
    if(pinyinOnly.checked){
      englishOnly.checked = false;
      main = target.pinyin;
    }else if(englishOnly.checked){
      pinyinOnly.checked = false;
      main = target.en;
    }else{
      main = (Math.random() < 0.5) ? target.pinyin : target.en;
    }
    promptMainEl.textContent = main;
    promptSubEl.textContent = "Catch the matching Ê±âÂ≠ó/ËØç";

    if(audioToggle.checked){
      speakChinese(target.speak || target.hanzi);
    }
  }

  // Spawning
  function spawnDumpling(){
    const useTarget = target && Math.random() < 0.45; // keep target appearing
    const item = useTarget ? target : VOCAB[Math.floor(Math.random()*VOCAB.length)];

    dumplings.push({
      x: 80 + Math.random()*(W-160),
      y: -60,
      vy: fallBase + Math.random()*fallJitter,
      item,
      r: 48,    // BIG bubble
      alive: true
    });
  }

  function rectsOverlap(a,b){
    return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
  }
  function dumplingRect(d){
    return { x:d.x-d.r*1.2, y:d.y-d.r, w:d.r*2.4, h:d.r*2 };
  }

  function onCatch(d){
    const correct = target && (d.item.hanzi === target.hanzi);

    if(correct){
      score += 100;
      streak += 1;
      floaters.push({x:d.x, y:d.y, vy:-30, text:"+$100 üíµüíµ", ttl:1.0, color:"#22c55e", size:30});
      beep("good");
      round += 1;
      pickTarget();
    }else{
      // Wrong: huge grass + bigger penalty text (you can set penalty=0 if you want)
      score -= 50;
      streak = 0;
      floaters.push({x:d.x, y:d.y, vy:-18, text:"üåøüåø -$50", ttl:1.15, color:"#f87171", size:30});
      beep("bad");
    }

    scoreEl.textContent = `$${score}`;
    streakEl.textContent = String(streak);
    d.alive = false;
  }

  // Drawing helpers
  function roundRect(x,y,w,h,r,fill=true,stroke=false){
    ctx.beginPath();
    if(ctx.roundRect){
      ctx.roundRect(x,y,w,h,r);
    }else{
      ctx.moveTo(x+r,y);
      ctx.lineTo(x+w-r,y);
      ctx.quadraticCurveTo(x+w,y,x+w,y+r);
      ctx.lineTo(x+w,y+h-r);
      ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);
      ctx.lineTo(x+r,y+h);
      ctx.quadraticCurveTo(x,y+h,x,y+h-r);
      ctx.lineTo(x,y+r);
      ctx.quadraticCurveTo(x,y,x+r,y);
    }
    if(fill) ctx.fill();
    if(stroke) ctx.stroke();
  }

  function drawBackground(){
    // darker sky gradient with stars
    const g = ctx.createLinearGradient(0,0,0,H);
    g.addColorStop(0,"#020617");
    g.addColorStop(0.55,"#0b1224");
    g.addColorStop(1,"#111827");
    ctx.fillStyle = g;
    ctx.fillRect(0,0,W,H);

    // stars
    ctx.globalAlpha = 0.65;
    for(let i=0;i<80;i++){
      const x = (i*97)%W;
      const y = (i*53)% (H*0.55);
      const s = (i%3)+1;
      ctx.fillStyle = "rgba(255,255,255,.35)";
      ctx.fillRect(x, y, s, s);
    }
    ctx.globalAlpha = 1;

    // ground
    ctx.fillStyle = "#0f172a";
    ctx.fillRect(0, groundY+34, W, H-(groundY+34));

    // ground line
    ctx.strokeStyle = "rgba(148,163,184,.25)";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(0, groundY+34);
    ctx.lineTo(W, groundY+34);
    ctx.stroke();
  }

  function drawPlayer(){
    const px = player.x, py = player.y;

    // shadow
    ctx.fillStyle = "rgba(0,0,0,.45)";
    ctx.beginPath();
    ctx.ellipse(px, py+56, 64, 16, 0, 0, Math.PI*2);
    ctx.fill();

    // legs
    ctx.strokeStyle = "#94a3b8";
    ctx.lineWidth = 10;
    ctx.lineCap="round";
    ctx.beginPath();
    ctx.moveTo(px-18, py+34); ctx.lineTo(px-26, py+54);
    ctx.moveTo(px+18, py+34); ctx.lineTo(px+26, py+54);
    ctx.stroke();

    // body
    ctx.fillStyle = "#60a5fa";
    roundRect(px-38, py-6, 76, 70, 18, true, false);

    // head
    ctx.fillStyle = "#fde68a";
    ctx.beginPath();
    ctx.ellipse(px, py-44, 26, 28, 0, 0, Math.PI*2);
    ctx.fill();

    // face
    ctx.fillStyle = "#0b1224";
    ctx.beginPath();
    ctx.ellipse(px-9, py-48, 3.5, 4, 0, 0, Math.PI*2);
    ctx.ellipse(px+9, py-48, 3.5, 4, 0, 0, Math.PI*2);
    ctx.fill();
    ctx.strokeStyle="#0b1224";
    ctx.lineWidth=3;
    ctx.beginPath();
    ctx.arc(px, py-38, 10, 0, Math.PI);
    ctx.stroke();

    // arms up
    ctx.strokeStyle = "#94a3b8";
    ctx.lineWidth = 9;
    ctx.lineCap="round";
    ctx.beginPath();
    ctx.moveTo(px-28, py-2); ctx.lineTo(px-52, py-62);
    ctx.moveTo(px+28, py-2); ctx.lineTo(px+52, py-62);
    ctx.stroke();

    // plate (bigger)
    const pr = plateRect();
    ctx.fillStyle = "rgba(248,250,252,.15)";
    roundRect(pr.x, pr.y, pr.w, pr.h, 16, true, false);
    ctx.strokeStyle = "rgba(167,139,250,.65)";
    ctx.lineWidth = 3;
    roundRect(pr.x, pr.y, pr.w, pr.h, 16, false, true);

    // inner rim
    ctx.strokeStyle = "rgba(56,189,248,.55)";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.roundRect(pr.x+10, pr.y+6, pr.w-20, pr.h-12, 14);
    ctx.stroke();
  }

  function drawDumpling(d){
    // BIGGER bubble
    ctx.fillStyle = "rgba(253,230,138,.95)";
    ctx.beginPath();
    ctx.ellipse(d.x, d.y, d.r*1.35, d.r*0.95, 0, 0, Math.PI*2);
    ctx.fill();

    ctx.strokeStyle = "rgba(255,255,255,.25)";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.ellipse(d.x, d.y, d.r*1.35, d.r*0.95, 0, 0, Math.PI*2);
    ctx.stroke();

    // highlight
    ctx.fillStyle = "rgba(255,255,255,.35)";
    ctx.beginPath();
    ctx.ellipse(d.x - 14, d.y - 10, d.r*0.6, d.r*0.38, 0, 0, Math.PI*2);
    ctx.fill();

    // BIGGER text inside
    ctx.fillStyle = "#0b1224";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.font = "900 34px system-ui, -apple-system, Segoe UI, Roboto";
    ctx.fillText(d.item.hanzi, d.x, d.y+2);
  }

  function drawFloaters(dt){
    for(const f of floaters){
      f.y += f.vy * dt;
      f.ttl -= dt;
      ctx.globalAlpha = Math.max(0, f.ttl);
      ctx.fillStyle = f.color;
      ctx.font = `900 ${f.size||28}px system-ui, -apple-system, Segoe UI, Roboto`;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(f.text, f.x, f.y);
      ctx.globalAlpha = 1;
    }
    floaters = floaters.filter(f => f.ttl > 0);
  }

  // Bottom-left target helper on canvas (bigger, higher contrast)
  function drawTargetBanner(){
    if(!target) return;
    const text = `Target: ${target.hanzi}  (${target.pinyin})`;
    ctx.font = "800 16px system-ui, -apple-system, Segoe UI, Roboto";
    const padX = 14, padY = 10;
    const w = ctx.measureText(text).width + padX*2;
    const h = 42;
    const x = 14, y = H - h - 14;

    ctx.fillStyle = "rgba(2,6,23,.65)";
    ctx.strokeStyle = "rgba(167,139,250,.55)";
    ctx.lineWidth = 2;
    roundRect(x, y, w, h, 14, true, true);

    ctx.fillStyle = "#f8fafc";
    ctx.textAlign = "left";
    ctx.textBaseline = "middle";
    ctx.fillText(text, x+padX, y+h/2+1);
  }

  // Loop
  let last = 0;
  function loop(ts){
    if(!running){ drawSplash(); requestAnimationFrame(loop); return; }
    if(paused){ drawPaused(); requestAnimationFrame(loop); return; }

    const t = ts/1000;
    const dt = Math.min(0.033, t - last);
    last = t;

    update(dt);
    render(dt);
    requestAnimationFrame(loop);
  }

  function update(dt){
    const left = keys.has("ArrowLeft") || keys.has("a") || keys.has("A");
    const right = keys.has("ArrowRight") || keys.has("d") || keys.has("D");
    if(left) player.x -= player.speed * dt;
    if(right) player.x += player.speed * dt;
    player.x = Math.max(90, Math.min(W-90, player.x));

    // spawn
    spawnTimer += dt;
    if(spawnTimer >= spawnEvery){
      spawnTimer = 0;
      spawnDumpling();
      if(Math.random() < 0.20) spawnDumpling();
    }

    // fall
    for(const d of dumplings){
      d.y += d.vy * dt;
      if(d.y > H + 120) d.alive = false;
    }

    // collision
    const pr = plateRect();
    for(const d of dumplings){
      if(!d.alive) continue;
      if(rectsOverlap(pr, dumplingRect(d))){
        onCatch(d);
      }
    }

    dumplings = dumplings.filter(d => d.alive);
  }

  function render(dt){
    drawBackground();
    for(const d of dumplings) drawDumpling(d);
    drawPlayer();
    drawFloaters(dt);
    drawTargetBanner();
  }

  function drawSplash(){
    drawBackground();
    drawPlayer();

    ctx.fillStyle="rgba(2,6,23,.72)";
    ctx.strokeStyle="rgba(167,139,250,.55)";
    ctx.lineWidth=2;
    roundRect(W/2-280, H/2-110, 560, 220, 18, true, true);

    ctx.fillStyle="#f8fafc";
    ctx.textAlign="center";
    ctx.textBaseline="middle";
    ctx.font="900 34px system-ui";
    ctx.fillText("ü•ü Â§©‰∏äÊéâÈ•∫Â≠ê", W/2, H/2-35);

    ctx.font="800 16px system-ui";
    ctx.fillStyle="#cbd5e1";
    ctx.fillText("Press Start ‚Ä¢ ‚Üê/‚Üí or A/D to move ‚Ä¢ Space to pause", W/2, H/2+18);
    ctx.fillText("Catch the dumpling that matches the prompt.", W/2, H/2+46);
  }

  function drawPaused(){
    render(0);
    ctx.fillStyle="rgba(0,0,0,.45)";
    ctx.fillRect(0,0,W,H);
    ctx.fillStyle="#fff";
    ctx.textAlign="center";
    ctx.textBaseline="middle";
    ctx.font="900 44px system-ui";
    ctx.fillText("Paused", W/2, H/2);
    ctx.font="800 16px system-ui";
    ctx.fillText("Press Space to resume", W/2, H/2+42);
  }

  // Controls
  function start(){
    score = 0; round = 1; streak = 0;
    dumplings = []; floaters = [];
    scoreEl.textContent = "$0";
    roundEl.textContent = "1";
    streakEl.textContent = "0";

    running = true; paused = false;
    last = performance.now()/1000;
    spawnTimer = 0;

    startBtn.disabled = true;
    pauseBtn.disabled = false;
    repeatBtn.disabled = false;
    pauseBtn.textContent = "Pause";

    pickTarget();
  }

  function togglePause(){
    if(!running) return;
    paused = !paused;
    pauseBtn.textContent = paused ? "Resume" : "Pause";
  }

  startBtn.addEventListener("click", start);
  pauseBtn.addEventListener("click", togglePause);
  repeatBtn.addEventListener("click", () => {
    if(target) speakChinese(target.speak || target.hanzi);
  });

  pinyinOnly.addEventListener("change", () => { if(pinyinOnly.checked) englishOnly.checked=false; if(target) pickTarget(); });
  englishOnly.addEventListener("change", () => { if(englishOnly.checked) pinyinOnly.checked=false; if(target) pickTarget(); });

  if("speechSynthesis" in window){
    window.speechSynthesis.onvoiceschanged = () => {};
  }

  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
